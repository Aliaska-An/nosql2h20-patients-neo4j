# NoSQL Модель данных
### 1. Графическое представление
<img src="https://github.com/moevm/nosql2h20-patients-neo4j/blob/DataModel/DataModel/images/nosql_model.png">


### Описание назначений коллекций, типов данных и сущностей
#### 1. Сущность sickPerson

Предназначена для хранения личной информации о заболевшем.
Содержит поля:
* *passportNumber* - уникальный номер паспорта заболевшего. Type: Int. Size: 4 Byte. 
* *name* - имя заболевшего. Type: String. Size: 50 (максимальный размер имени) * 2 Byte.
* *surname* - фамилия заболевшего. Type: String. Size: 50 (максимальный размер фамилия) * 2 Byte.
* *age* - возраст заболевшего. Type: Int. Size: 4 Byte. 
* *DateOfBirth* - дата рождения заболевшего. Type: Date. Size: 8 Byte. 
* *Country* - страна, в которой живет заболевший. Type: String. Size: 50 (максимальный размер названия страны) * 2 Byte.
* *City* - город, в котором живет заболевший. Type: String. Size: 50 (максимальный размер названия города) * 2 Byte.

*Total size:* ***416 Byte***

#### 2. Сущность desease

Предназначена для хранения информации о существующих болезнях.
Содержит поля:
* *deseaseID* - уникальный болезни. Type: Int. Size: 4 Byte. 
* *name* - название болезни. Type: String. Size: 50 (максимальный размер для названия болезни) * 2 Byte.

*Total size:* ***104 Byte***

#### 3. Сущность contacts

Предназначена для хранения личной информации о человеке, который контактировал с заболевшим.
Содержит поля:
* *passportNumber* - уникальный номер паспорта контактирующего. Type: Int. Size: 4 Byte. 
* *name* - имя контактирующего. Type: String. Size: 50 (максимальный размер имени) * 2 Byte.
* *surname* - фамилия контактирующего. Type: String. Size: 50 (максимальный размер фамилия) * 2 Byte.
* *age* - возраст контактирующего. Type: Int. Size: 4 Byte. 
* *DateOfBirth* - дата рождения контактирующего. Type: Date. Size: 8 Byte. 
* *Country* - страна, в которой живет контактирующий. Type: String. Size: 50 (максимальный размер названия страны) * 2 Byte.
* *City* - город, в котором живет контактирующий. Type: String. Size: 50 (максимальный размер названия города) * 2 Byte.

*Total size:* ***416 Byte***

Существует 2 связи между сущностями:
* *has_contact* - данный больной контактировал с конкретным человеком. Дополнительных полей нет.
* *has_desease* - данный больной болеет конкретной болезнью. Дополнительные поля:
  * *deseaseStart* - дата начала болезни. Type: Date. Size: 8 Byte.
  * *deseaseEnd* - дата выздоровления. Type: Date. Size: 8 Byte.
  
*Total size:* ***16 Byte***

### Оценка удельного объема информации, хранимой в модели (сколько потребуется памяти, чтобы сохранить объекты, как объем зависит от количества объектов)

Пусть:
* Количество заболевших равняется A.
* Среднее количество контактов у заболевшего равняется 5 и у каждого человека различный список контактов.
* Среднее количество болезней у человека равняется 2 и у каждого человека различный список болезней.

1. Чистый объем 
   * *sickPerson* - A * 416B
   * *desease* - A * 2 * 104B
   * *contacts* - A * 5 * 416B
   * *has_desease* - A * 2 * 16B
   
*Тогда занимаемый "чистый" объем:* ***A * 2736B***

2. Фактический объем
   * *sickPerson* - A * 824B
   * *desease* - A * 2 * 184B
   * *contacts* - A * 5 * 824B
   * *has_desease* - A * 2 * 116B
   * *has_contact* - A * 5 * 34B
  
*Тогда занимаемый "фактический" объем:* ***A * 5714B***

Избыточность модели: (A * 2736)/(A * 5714B)

### Запросы к модели, с помощью которых реализуются сценарии использования

* Добавление нового заболевшего:

```
CREATE (n:sickPerson {...})
```
* Добавление нового контакта:

```
CREATE (n:contacts {...})
```

* Добавление нового контакта для заболевшего
```
MATCH (a:sickPerson),(b:contacts)
WHERE a.passportNumber = '...' AND b.passportNumber = '...'
CREATE (a)-[r:has_contact]->(b)
RETURN type(r)
```
* Подсчет общего числа заболевших
```
MATCH (n:sickPerson)
RETURN count(n) as count
```

* Количество заболевших в данный момент
```
MATCH ()-[r:has_desease]->()
WHERE r.deseaseStart >= date() AND r.deseaseEnd =< date()
RETURN count(r) as count
```
